"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[502],{12154:function(ne,b,i){i.r(b),i.d(b,{default:function(){return xe}});var F=i(97857),A=i.n(F),N=i(15009),v=i.n(N),j=i(99289),S=i.n(j),P=i(5574),p=i.n(P),k=i(27986),R=i(94272),g=i(66309),J=i(38703),le=i(83062),U=i(11499),E=i(74330),l=i(26412),X=i(86250),L=i(4393),e=i(85893),oe=function(V){var t=V.record,o=(0,R.useIntl)(),M=sessionStorage.getItem("mj-image-prefix")||"",w=function(s){var c="default";return s=="NOT_START"?c="default":s=="SUBMITTED"?c="lime":s=="MODAL"?c="warning":s=="IN_PROGRESS"?c="processing":s=="FAILURE"?c="error":s=="SUCCESS"?c="success":s=="CANCEL"&&(c="magenta"),(0,e.jsx)(g.Z,{color:c,children:t.displays.status})},D=function(s){var c=0;s&&s.indexOf("%")>0&&(c=parseInt(s.substring(0,s.indexOf("%"))));var T="normal";return t.status=="SUCCESS"?T="success":t.status=="FAILURE"&&(T="exception"),(0,e.jsx)("div",{style:{width:200},children:(0,e.jsx)(J.Z,{percent:c,status:T})})},h=function(s){return!s||s.length<30?s:(0,e.jsx)(le.Z,{title:s,children:s.substring(0,30)+"..."})},Z=function(s){return s&&(0,e.jsx)(U.Z,{width:200,src:M+s,placeholder:(0,e.jsx)(E.Z,{tip:"Loading",size:"large"})})},B=function(s){return s&&(0,e.jsx)("video",{width:"200",controls:!0,src:M+s,placeholder:(0,e.jsx)(E.Z,{tip:"Loading",size:"large"})})},W=function(){return!t.videoUrls||t.videoUrls.length===0?null:(0,e.jsxs)("div",{className:"video-task-detail",children:[(0,e.jsxs)("div",{className:"video-info",style:{marginBottom:"16px"},children:[(0,e.jsxs)(g.Z,{color:"blue",children:["\u65F6\u957F: ",t.videoDuration,"s"]}),(0,e.jsxs)(g.Z,{color:"green",children:["\u5E27\u6570: ",t.frameCount]})]}),(0,e.jsx)("div",{className:"videos-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:t.videoUrls.map(function(s,c){return(0,e.jsx)("div",{className:"video-detail-item",children:(0,e.jsxs)("div",{style:{position:"relative",marginBottom:"8px"},children:[(0,e.jsxs)("video",{controls:!0,loop:!0,muted:!0,style:{width:"200px",height:"200px",objectFit:"cover",borderRadius:"8px"},poster:t.videoGenOriginImageUrl,children:[(0,e.jsx)("source",{src:s.url,type:"video/mp4"}),"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u89C6\u9891\u64AD\u653E\u3002"]}),(0,e.jsxs)("div",{style:{position:"absolute",top:"8px",right:"8px",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:["#",c+1]})]})},c)})}),t.videoGenOriginImageUrl&&(0,e.jsxs)("div",{style:{marginTop:"16px"},children:[(0,e.jsx)("div",{style:{marginBottom:"8px",fontWeight:"bold"},children:"\u539F\u59CB\u56FE\u7247:"}),Z(t.videoGenOriginImageUrl)]})]})},G=function(s){return s=="NIJI_JOURNEY"?(0,e.jsx)(g.Z,{color:"green",children:"niji\u30FBjourney"}):s=="INSIGHT_FACE"||s=="FACE_SWAP"||s=="FACE_SWAP_VIDEO"?(0,e.jsx)(g.Z,{color:"volcano",children:"InsightFace"}):s=="MID_JOURNEY"?(0,e.jsx)(g.Z,{color:"blue",children:"Midjourney"}):"-"},H=function(s){if(!(s==null||!s))return(0,e.jsx)(g.Z,{color:"green",children:o.formatMessage({id:"pages.yes"})})},z=function(){return t.action==="SWAP_VIDEO_FACE"||t.contentType==="video/mp4"?(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.video"}),children:(0,e.jsxs)(X.Z,{vertical:!0,children:[t.videoDuration&&(0,e.jsxs)("div",{className:"video-info",style:{marginBottom:"16px"},children:[(0,e.jsxs)(g.Z,{color:"blue",children:["\u65F6\u957F: ",t.videoDuration,"s"]}),(0,e.jsxs)(g.Z,{color:"green",children:["\u5E27\u6570: ",t.frameCount]})]}),B(t.imageUrl)]})}):(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.image"}),children:(0,e.jsxs)(X.Z,{vertical:!0,children:[t.videoDuration&&(0,e.jsxs)("div",{className:"video-info",style:{marginBottom:"16px"},children:[(0,e.jsxs)(g.Z,{color:"blue",children:["\u65F6\u957F: ",t.videoDuration,"s"]}),(0,e.jsxs)(g.Z,{color:"green",children:["\u5E27\u6570: ",t.frameCount]})]}),Z(t.imageUrl)]})})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(L.Z,{type:"inner",title:o.formatMessage({id:"pages.account.basicInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(l.Z,{column:2,children:[(0,e.jsx)(l.Z.Item,{label:"ID",children:t.id}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.type"}),children:t.displays.action}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.status"}),children:w(t.status)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.progress"}),children:D(t.progress)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.prompt"}),children:h(t.prompt)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.promptEn"}),children:h(t.promptEn)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.description"}),children:h(t.description)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.submitTime"}),children:t.displays.submitTime}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.startTime"}),children:t.displays.startTime}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.finishTime"}),children:t.displays.finishTime}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.failReason"}),children:h(t.failReason)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.state"}),children:h(t.state)}),z()]})}),(0,e.jsx)(L.Z,{type:"inner",title:o.formatMessage({id:"pages.task.extendedInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(l.Z,{column:2,children:[(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.botType"}),children:G(t.botType)}),(0,e.jsx)(l.Z.Item,{label:"Nonce",children:t.nonce}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.account.channelId"}),children:t.properties.discordInstanceId}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.instanceId"}),children:t.properties.discordInstanceId}),(0,e.jsx)(l.Z.Item,{label:"Hash",children:t.properties.messageHash}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.messageContent"}),children:h(t.properties.messageContent)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.finalPrompt"}),children:h(t.properties.finalPrompt)}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.finalPromptZh"}),children:h(t.promptCn||"-")}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.actionId"}),children:h(t.properties.custom_id||"-")}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.modalConfirm"}),children:H(t.properties.needModel)||"-"}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.imageSeed"}),children:t.seed||"-"}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.notifyHook"}),children:h(t.properties.notifyHook||"-")}),(0,e.jsx)(l.Z.Item,{label:o.formatMessage({id:"pages.task.ip"}),children:t.clientIp||"-"})]})})]})},de=oe,K=i(66927),ue=i(74842),ce=i(82061),me=i(90930),ge=i(99191),fe=i(53025),pe=i(16568),Y=i(28036),he=i(86738),ve=i(28248),x=i(67294),Ie=function(){var V=(0,x.useState)(!1),t=p()(V,2),o=t[0],M=t[1],w=(0,x.useState)({}),D=p()(w,2),h=D[0],Z=D[1],B=(0,x.useState)(""),W=p()(B,2),G=W[0],H=W[1],z=(0,x.useState)({}),I=p()(z,2),s=I[0],c=I[1],T=(0,x.useState)(1e3),Q=p()(T,2),Se=Q[0],Ee=Q[1],Ce=fe.Z.useForm(),Me=p()(Ce,1),Ze=Me[0],m=(0,R.useIntl)(),Te=sessionStorage.getItem("mj-image-prefix")||"",ye=pe.ZP.useNotification(),q=p()(ye,2),_=q[0],be=q[1],ee=(0,x.useRef)(),Ae=function(){Z({}),c({}),M(!1)},Re=function(r,a,n,d){Ze.resetFields(),H(r),Z(a),c(n),Ee(d),M(!0)},Ue=function(){var u=S()(v()().mark(function r(a){var n,d;return v()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,(0,K._5)(a);case 3:n=f.sent,n.success?(_.success({message:"success",description:m.formatMessage({id:"pages.task.deleteSuccess"})}),(d=ee.current)===null||d===void 0||d.reload()):_.error({message:"error",description:n.message}),f.next=10;break;case 7:f.prev=7,f.t0=f.catch(0),console.error(f.t0);case 10:return f.prev=10,f.finish(10);case 12:case"end":return f.stop()}},r,null,[[0,7,10,12]])}));return function(a){return u.apply(this,arguments)}}(),De=(0,x.useState)(!0),te=p()(De,2),$=te[0],Oe=te[1],ae=function(){Oe(!1)},we=function(r){return r&&(0,e.jsx)("video",{width:"200",controls:!0,src:Te+r,placeholder:(0,e.jsx)(E.Z,{tip:"Loading",size:"large"})})},Fe=(0,x.useState)(!1),se=p()(Fe,2),Ne=se[0],re=se[1],Pe=(0,x.useState)(""),ie=p()(Pe,2),ke=ie[0],Le=ie[1],Ve=[{title:"ID",dataIndex:"id",width:160,align:"center",fixed:"left",render:function(r,a){return(0,e.jsx)("a",{onClick:function(){return Re(m.formatMessage({id:"pages.task.info"}),(0,e.jsx)(de,{record:a}),null,1100)},children:r})}},{title:m.formatMessage({id:"pages.task.type"}),dataIndex:"action",width:140,align:"center",request:function(){var u=S()(v()().mark(function a(){return v()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:"IMAGINE (\u60F3\u8C61)",value:"IMAGINE"},{label:"UPSCALE (\u653E\u5927)",value:"UPSCALE"},{label:"UPSCALE_HD (\u9AD8\u6E05)",value:"UPSCALE_HD"},{label:"VARIATION (\u53D8\u5316)",value:"VARIATION"},{label:"ZOOM (\u53D8\u7126)",value:"ZOOM"},{label:"PAN (\u5E73\u79FB)",value:"PAN"},{label:"DESCRIBE (\u56FE\u751F\u6587)",value:"DESCRIBE"},{label:"BLEND (\u6DF7\u56FE)",value:"BLEND"},{label:"SHORTEN (\u7B80\u5316)",value:"SHORTEN"},{label:"VIDEO (\u89C6\u9891)",value:"VIDEO"},{label:"EDIT (\u7F16\u8F91)",value:"EDIT"},{label:"RETEXTURE (\u8F6C\u7ED8)",value:"RETEXTURE"},{label:"SWAP_FACE (\u56FE\u7247\u6362\u8138)",value:"SWAP_FACE"},{label:"SWAP_VIDEO_FACE (\u89C6\u9891\u6362\u8138)",value:"SWAP_VIDEO_FACE"}]);case 1:case"end":return d.stop()}},a)}));function r(){return u.apply(this,arguments)}return r}(),render:function(r,a){return a.displays.action}},{title:m.formatMessage({id:"pages.task.preview"}),dataIndex:"imageUrl",width:80,align:"center",hideInSearch:!0,render:function(r,a,n){return a.action==="SWAP_VIDEO_FACE"?a.thumbnailUrl&&(0,e.jsx)(U.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover",cursor:"pointer"},height:60,src:a.thumbnailUrl,preview:!1,onClick:function(){window.open(a.imageUrl)},loading:"lazy",onLoad:ae,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(E.Z,{spinning:$})})},n):a.contentType==="video/mp4"?(0,e.jsx)("div",{style:{position:"relative",cursor:"pointer",display:"inline-block"},onClick:function(){Le(a.imageUrl||a.url),re(!0)},children:(0,e.jsx)(Y.ZP,{icon:(0,e.jsx)(ue.Z,{})})}):(a.thumbnailUrl||a.imageUrl)&&(0,e.jsx)(U.Z.PreviewGroup,{items:a.images||[],children:(0,e.jsx)(U.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover"},height:60,src:a.action==="VIDEO"?a.imageUrl:a.thumbnailUrl||a.imageUrl,preview:{src:a.imageUrl,mask:(0,e.jsx)(E.Z,{spinning:$})},loading:"lazy",onLoad:ae,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(E.Z,{spinning:$})})},n)})}},{title:m.formatMessage({id:"pages.task.instanceId"}),dataIndex:"instanceId",width:180,align:"center",render:function(r,a){return a.properties.discordInstanceId}},{title:m.formatMessage({id:"pages.task.submitTime"}),dataIndex:"submitTime",width:160,hideInSearch:!0,align:"center",render:function(r,a){return a.displays.submitTime}},{title:m.formatMessage({id:"pages.task.status"}),dataIndex:"status",width:90,align:"center",request:function(){var u=S()(v()().mark(function a(){return v()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:"NOT_START (\u672A\u5F00\u59CB)",value:"NOT_START"},{label:"SUBMITTED (\u5DF2\u63D0\u4EA4)",value:"SUBMITTED"},{label:"MODAL (\u5F39\u7A97\u7B49\u5F85)",value:"MODAL"},{label:"IN_PROGRESS (\u6267\u884C\u4E2D)",value:"IN_PROGRESS"},{label:"FAILURE (\u5931\u8D25)",value:"FAILURE"},{label:"SUCCESS (\u6210\u529F)",value:"SUCCESS"},{label:"CANCEL (\u5DF2\u53D6\u6D88)",value:"CANCEL"}]);case 1:case"end":return d.stop()}},a)}));function r(){return u.apply(this,arguments)}return r}(),render:function(r,a){var n="default";return r=="NOT_START"?n="default":r=="SUBMITTED"?n="lime":r=="MODAL"?n="warning":r=="IN_PROGRESS"?n="processing":r=="FAILURE"?n="error":r=="SUCCESS"?n="success":r=="CANCEL"&&(n="magenta"),(0,e.jsx)(g.Z,{color:n,children:a.displays.status})}},{title:m.formatMessage({id:"pages.task.mode"}),dataIndex:"mode",width:90,align:"center",request:function(){var u=S()(v()().mark(function a(){return v()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:"RELAX",value:"RELAX"},{label:"FAST",value:"FAST"},{label:"TURBO",value:"TURBO"}]);case 1:case"end":return d.stop()}},a)}));function r(){return u.apply(this,arguments)}return r}(),render:function(r,a){return a.mode||"FAST"}},{title:m.formatMessage({id:"pages.task.progress"}),dataIndex:"progress",width:130,showInfo:!1,hideInSearch:!0,render:function(r,a){var n=0;r&&r.indexOf("%")>0&&(n=parseInt(r.substring(0,r.indexOf("%"))));var d="normal";return a.status=="SUCCESS"?d="success":a.status=="FAILURE"&&(d="exception"),(0,e.jsx)(J.Z,{percent:n,status:d,size:"small"})}},{title:m.formatMessage({id:"pages.task.useTime"}),dataIndex:"useTime",width:80,ellipsis:!0},{title:m.formatMessage({id:"pages.task.description"}),dataIndex:"description",width:250,ellipsis:!0},{title:m.formatMessage({id:"pages.task.failReason"}),dataIndex:"failReason",width:220,ellipsis:!0},{title:m.formatMessage({id:"pages.operation"}),dataIndex:"operation",width:100,key:"operation",fixed:"right",align:"center",hideInSearch:!0,render:function(r,a){return(0,e.jsx)(he.Z,{title:m.formatMessage({id:"pages.task.delete"}),description:m.formatMessage({id:"pages.task.deleteTitle"}),onConfirm:function(){return Ue(a.id)},children:(0,e.jsx)(Y.ZP,{danger:!0,icon:(0,e.jsx)(ce.Z,{})})})}}];return(0,e.jsxs)(me._z,{children:[be,(0,e.jsx)(L.Z,{children:(0,e.jsx)(ge.Z,{columns:Ve,scroll:{x:1e3},search:{defaultCollapsed:!0},pagination:{pageSize:10,showQuickJumper:!1,showSizeChanger:!1},rowKey:"id",actionRef:ee,request:function(){var u=S()(v()().mark(function r(a){var n,d,O;return v()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,K.Pn)(A()(A()({},a),{},{pageNumber:a.current-1}));case 2:return n=C.sent,d=n.list.map(function(y){return y.imageUrl||""}).filter(function(y){return y!=""}),O=n.list,O.forEach(function(y,Be){y.images=d}),C.abrupt("return",{data:O,total:n.pagination.total,success:!0});case 7:case"end":return C.stop()}},r)}));return function(r){return u.apply(this,arguments)}}()})}),(0,e.jsx)(k.Z,{title:G,modalVisible:o,hideModal:Ae,modalContent:h,footer:s,modalWidth:Se}),(0,e.jsx)(ve.Z,{title:"\u89C6\u9891\u64AD\u653E",open:Ne,onCancel:function(){return re(!1)},footer:null,width:800,centered:!0,destroyOnClose:!0,children:(0,e.jsxs)("video",{controls:!0,autoPlay:!0,width:"100%",style:{maxHeight:"400px"},children:[(0,e.jsx)("source",{src:ke,type:"video/mp4"}),"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u89C6\u9891\u64AD\u653E"]})})]})},xe=Ie},27986:function(ne,b,i){var F=i(28248),A=i(85893),N=function(j){var S=j.title,P=j.modalVisible,p=j.hideModal,k=j.modalContent,R=j.footer,g=j.modalWidth;return(0,A.jsx)(F.Z,{title:S,open:P,onCancel:p,footer:R,width:g,children:k})};b.Z=N}}]);
