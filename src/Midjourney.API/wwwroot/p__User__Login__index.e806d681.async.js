"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[366],{42110:function(_,C){var e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"};C.Z=e},94149:function(_,C,e){e.d(C,{Z:function(){return M}});var B=e(1413),Z=e(67294),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},I=D,U=e(89099),z=function(l,g){return Z.createElement(U.Z,(0,B.Z)((0,B.Z)({},l),{},{ref:g,icon:I}))},w=Z.forwardRef(z),M=w},44935:function(_,C,e){e.r(C),e.d(C,{default:function(){return He}});var B=e(15009),Z=e.n(B),D=e(97857),I=e.n(D),U=e(99289),z=e.n(U),w=e(5574),M=e.n(w),N=e(66927),l=e(1413),g=e(67294),ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"},re=ae,ie=e(89099),le=function(a,t){return g.createElement(ie.Z,(0,l.Z)((0,l.Z)({},a),{},{ref:t,icon:re}))},se=g.forwardRef(le),oe=se,de=e(94149),$=e(91),ue=e(10915),ce=e(28459),ge=e(93967),ve=e.n(ge),fe=e(34994),b=e(4942),he=e(98082),me=function(a){return(0,b.Z)((0,b.Z)({},a.componentCls,{"&-container":{display:"flex",flex:"1",flexDirection:"column",height:"100%",paddingInline:32,paddingBlock:24,overflow:"auto",background:"inherit"},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",insetBlockStart:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:a.colorTextSecondary,fontSize:a.fontSize},"&-main":{minWidth:"328px",maxWidth:"580px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),"@media (min-width: @screen-md-min)",(0,b.Z)({},"".concat(a.componentCls,"-container"),{paddingInline:0,paddingBlockStart:32,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"}))};function pe(s){return(0,he.Xj)("LoginForm",function(a){var t=(0,l.Z)((0,l.Z)({},a),{},{componentCls:".".concat(s)});return[me(t)]})}var n=e(85893),xe=["logo","message","contentStyle","title","subTitle","actions","children","containerStyle","otherStyle"];function Se(s){var a,t=s.logo,d=s.message,i=s.contentStyle,p=s.title,x=s.subTitle,y=s.actions,c=s.children,j=s.containerStyle,h=s.otherStyle,r=(0,$.Z)(s,xe),Q=(0,ue.YB)(),X=r.submitter===!1?!1:(0,l.Z)((0,l.Z)({searchConfig:{submitText:Q.getMessage("loginForm.submitText","\u767B\u5F55")}},r.submitter),{},{submitButtonProps:(0,l.Z)({size:"large",style:{width:"100%"}},(a=r.submitter)===null||a===void 0?void 0:a.submitButtonProps),render:function(A,k){var o,v=k.pop();if(typeof(r==null||(o=r.submitter)===null||o===void 0?void 0:o.render)=="function"){var S,f;return r==null||(S=r.submitter)===null||S===void 0||(f=S.render)===null||f===void 0?void 0:f.call(S,A,k)}return v}}),V=(0,g.useContext)(ce.ZP.ConfigContext),W=V.getPrefixCls("pro-form-login"),R=pe(W),Y=R.wrapSSR,F=R.hashId,m=function(A){return"".concat(W,"-").concat(A," ").concat(F)},O=(0,g.useMemo)(function(){return t?typeof t=="string"?(0,n.jsx)("img",{src:t}):t:null},[t]);return Y((0,n.jsxs)("div",{className:ve()(m("container"),F),style:j,children:[(0,n.jsxs)("div",{className:"".concat(m("top")," ").concat(F).trim(),children:[p||O?(0,n.jsxs)("div",{className:"".concat(m("header")),children:[O?(0,n.jsx)("span",{className:m("logo"),children:O}):null,p?(0,n.jsx)("span",{className:m("title"),children:p}):null]}):null,x?(0,n.jsx)("div",{className:m("desc"),children:x}):null]}),(0,n.jsxs)("div",{className:m("main"),style:(0,l.Z)({width:328},i),children:[(0,n.jsxs)(fe.A,(0,l.Z)((0,l.Z)({isKeyPressSubmit:!0},r),{},{submitter:X,children:[d,c]})),y?(0,n.jsx)("div",{className:m("main-other"),style:h,children:y}):null]})]}))}var ee=e(97685),ye=e(21770),Pe=e(53025),Ze=e(55241),je=e(97435),G=e(67615),Ce=["fieldProps","proFieldProps"],Me=["fieldProps","proFieldProps"],H="text",Te=function(a){var t=a.fieldProps,d=a.proFieldProps,i=(0,$.Z)(a,Ce);return(0,n.jsx)(G.Z,(0,l.Z)({valueType:H,fieldProps:t,filedConfig:{valueType:H},proFieldProps:d},i))},Ae=function(a){var t=(0,ye.Z)(a.open||!1,{value:a.open,onChange:a.onOpenChange}),d=(0,ee.Z)(t,2),i=d[0],p=d[1];return(0,n.jsx)(Pe.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(y){var c,j=y.getFieldValue(a.name||[]);return(0,n.jsx)(Ze.Z,(0,l.Z)((0,l.Z)({getPopupContainer:function(r){return r&&r.parentNode?r.parentNode:r},onOpenChange:function(r){return p(r)},content:(0,n.jsxs)("div",{style:{padding:"4px 0"},children:[(c=a.statusRender)===null||c===void 0?void 0:c.call(a,j),a.strengthText?(0,n.jsx)("div",{style:{marginTop:10},children:(0,n.jsx)("span",{children:a.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},a.popoverProps),{},{open:i,children:a.children}))}})},Le=function(a){var t=a.fieldProps,d=a.proFieldProps,i=(0,$.Z)(a,Me),p=(0,g.useState)(!1),x=(0,ee.Z)(p,2),y=x[0],c=x[1];return t!=null&&t.statusRender&&i.name?(0,n.jsx)(Ae,{name:i.name,statusRender:t==null?void 0:t.statusRender,popoverProps:t==null?void 0:t.popoverProps,strengthText:t==null?void 0:t.strengthText,open:y,onOpenChange:c,children:(0,n.jsx)("div",{children:(0,n.jsx)(G.Z,(0,l.Z)({valueType:"password",fieldProps:(0,l.Z)((0,l.Z)({},(0,je.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(h){var r;t==null||(r=t.onBlur)===null||r===void 0||r.call(t,h),c(!1)},onClick:function(h){var r;t==null||(r=t.onClick)===null||r===void 0||r.call(t,h),c(!0)}}),proFieldProps:d,filedConfig:{valueType:H}},i))})}):(0,n.jsx)(G.Z,(0,l.Z)({valueType:"password",fieldProps:t,proFieldProps:d,filedConfig:{valueType:H}},i))},J=Te;J.Password=Le,J.displayName="ProFormComponent";var Re=J,te=e(24556),L=e(80854),T=e(2453),Fe=e(55102),Oe=e(42075),K=e(14726),Be=e(73935),Ie=e(67610),ze=function(){var a=(0,te.l)(function(t){var d=t.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:d.borderRadius,":hover":{backgroundColor:d.colorBgTextHover}}});return(0,n.jsx)("div",{className:a,"data-lang":!0,children:L.SelectLang&&(0,n.jsx)(L.SelectLang,{})})},Ne=function(){var a=(0,L.useModel)("@@initialState"),t=a.initialState,d=a.setInitialState,i=(0,L.useIntl)(),p=(0,g.useState)(!1),x=M()(p,2),y=x[0],c=x[1],j=(0,g.useState)(),h=M()(j,2),r=h[0],Q=h[1],X=(0,g.useState)(!1),V=M()(X,2),W=V[0],R=V[1],Y=(0,te.l)(function(){return{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}),F=function(){if(!r){T.ZP.error("Please input email");return}R(!0),(0,N.z2)(JSON.stringify({email:r})).then(function(v){R(!1),v.success?(T.ZP.success(i.formatMessage({id:"pages.login.registerSuccess"})),c(!1)):T.ZP.error(v.message)})},m=function(){var o=z()(Z()().mark(function v(S){var f,P,q,ne;return Z()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,(0,N.x4)(JSON.stringify(S.password||""));case 3:if(f=u.sent,f.code!==1){u.next=12;break}return f&&f.apiSecret&&sessionStorage.setItem("mj-api-secret",f.apiSecret),T.ZP.success(i.formatMessage({id:"pages.login.success"})),u.next=9,t==null||(P=t.fetchUserInfo)===null||P===void 0?void 0:P.call(t);case 9:return q=u.sent,q&&((0,Be.flushSync)(function(){d(function(Ve){return I()(I()({},Ve),{},{currentUser:q})})}),location.hash="#/welcome"),u.abrupt("return");case 12:T.ZP.error(f.description),u.next=19;break;case 15:u.prev=15,u.t0=u.catch(0),ne=i.formatMessage({id:"pages.login.failure"}),T.ZP.error(ne);case 19:case"end":return u.stop()}},v,null,[[0,15]])}));return function(S){return o.apply(this,arguments)}}(),O=(0,g.useState)(!1),E=M()(O,2),A=E[0],k=E[1];return(0,g.useEffect)(function(){(0,N.rw)().then(function(o){o.success&&o.data&&k(o.data.isRegister)})},[]),(0,n.jsxs)("div",{className:Y,children:[(0,n.jsx)(L.Helmet,{children:(0,n.jsxs)("title",{children:[i.formatMessage({id:"menu.login"})," - ",Ie.Z.title]})}),(0,n.jsx)(ze,{}),(0,n.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:y&&A?(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",height:"100vh",width:"360px",margin:"0 auto"},children:[(0,n.jsx)(Fe.Z,{name:"email",size:"large",prefix:(0,n.jsx)(oe,{}),placeholder:i.formatMessage({id:"pages.register.email.placeholder",defaultMessage:"Email"}),value:r,onChange:function(v){Q(v.target.value)}}),(0,n.jsxs)(Oe.Z,{style:{marginTop:"16px"},children:[(0,n.jsx)(K.ZP,{loading:W,style:{width:200},type:"primary",size:"large",onClick:F,children:i.formatMessage({id:"pages.login.register"})}),(0,n.jsx)(K.ZP,{type:"link",onClick:function(){c(!1)},children:i.formatMessage({id:"pages.login.returnLogin"})})]})]}):(0,n.jsx)(Se,{contentStyle:{minWidth:280,maxWidth:"75vw",height:"auto"},title:"Midjourney Proxy Admin",subTitle:i.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},onFinish:function(){var o=z()(Z()().mark(function v(S){return Z()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,m(S);case 2:case"end":return P.stop()}},v)}));return function(v){return o.apply(this,arguments)}}(),actions:A&&(0,n.jsx)(K.ZP,{type:"link",onClick:function(){c(!0)},style:{paddingLeft:0},children:i.formatMessage({id:"pages.login.registerAccount"})}),children:(0,n.jsx)(Re.Password,{name:"password",fieldProps:{size:"large",prefix:(0,n.jsx)(de.Z,{})},placeholder:i.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"Admin Token"})})})})]})},He=Ne}}]);
